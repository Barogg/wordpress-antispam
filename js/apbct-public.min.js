function apbct_collect_visible_fields(e){var t,o=[],i="",l=0,c="",n=0,a=[];for(t in e.elements)isNaN(+t)||(o[t]=e.elements[t]);return(o=o.filter(function(e){return-1===a.indexOf(e.getAttribute("name"))&&(-1===["radio","checkbox"].indexOf(e.getAttribute("type"))||(a.push(e.getAttribute("name")),!1))})).forEach(function(e,t,o){"submit"!==e.getAttribute("type")&&null!==e.getAttribute("name")&&"ct_checkjs"!==e.getAttribute("name")&&("none"!==getComputedStyle(e).display&&"hidden"!==getComputedStyle(e).visibility&&"0"!==getComputedStyle(e).opacity&&"hidden"!==e.getAttribute("type")||e.classList.contains("wp-editor-area")?(i+=" "+e.getAttribute("name"),l++):(c+=" "+e.getAttribute("name"),n++))}),c=c.trim(),{visible_fields:i=i.trim(),visible_fields_count:l,invisible_fields:c,invisible_fields_count:n}}function apbct_visible_fields_set_cookie(e,t){var o="object"==typeof e&&null!==e?e:{};if("native"===ctPublic.data__cookies_type)for(var i in o){if(10<i)return;ctSetCookie("apbct_visible_fields_"+(void 0!==t?t:i),JSON.stringify(o[i]))}else ctSetCookie("apbct_visible_fields",JSON.stringify(o))}function apbct_js_keys__set_input_value(e,t,o,i){if(0<document.querySelectorAll("[name^=ct_checkjs]").length)for(var l=document.querySelectorAll("[name^=ct_checkjs]"),c=0;c<l.length;c++)l[c].value=e.js_key}function apbctGetScreenInfo(){return JSON.stringify({fullWidth:document.documentElement.scrollWidth,fullHeight:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),visibleWidth:document.documentElement.clientWidth,visibleHeight:document.documentElement.clientHeight})}function ctSetPixelUrlLocalstorage(e){console.log("::set_pixel_url_localstorage call..."),localStorage.setItem("session_pixel_url",e),localStorage.setItem(e,Math.floor(Date.now()/1e3).toString())}function ctGetPixelUrlLocalstorage(){console.log("::get_pixel_url_localstorage call...");var e=localStorage.getItem("session_pixel_url");return null!==e?(console.log("Result:"+e),e):(console.log("Result: FALSE"),!1)}function ctIsOutdatedPixelUrlLocalstorage(e){console.log("::is_outdated_pixel_url_localstorage call...");var e=Number(localStorage.getItem(e)),t=(console.log("-local_storage_pixel_timestamp is "+e),Math.floor(Date.now()/1e3).toString()),t=(console.log("-current timestamp is "+t),t-e);return console.log("-current timestamp_difference is "+t),10800<t?(console.log("RESULT: OUTDATED"),!0):(console.log("RESULT: OK"),!1)}function ctCleaPixelUrlLocalstorage(e){console.log("clear_pixel_url_localstorage call..."),localStorage.removeItem(e),localStorage.removeItem("session_pixel_url")}!function(){var l=new Date,t=(new Date).getTime(),o=!0,i=[],c=0,n={},e=!1,a=!1;function s(e,t,o){"function"==typeof window.addEventListener?e.addEventListener(t,o):e.attachEvent(t,o)}function r(e,t,o){"function"==typeof window.removeEventListener?e.removeEventListener(t,o):e.detachEvent(t,o)}var u=function(e){var t=Math.floor((new Date).getTime()/1e3);ctSetCookie("ct_fkp_timestamp",t),r(window,"mousedown",u),r(window,"keydown",u)},_=setInterval(function(){o=!0},150),d=setInterval(function(){ctSetCookie("ct_pointer_data",JSON.stringify(i))},1200),m=function(e){a||(ctSetCookie("ct_mouse_moved","true"),a=!0),!0===o&&(i.push([Math.round(e.clientY),Math.round(e.clientX),Math.round((new Date).getTime()-t)]),o=!1,50<=++c&&(r(window,"mousemove",m),clearInterval(_),clearInterval(d)))};function p(e){var t=e.target.value;!t||t in n||("rest"===ctPublicFunctions.data__ajax_type?apbct_public_sendREST("check_email_before_post",{method:"POST",data:{email:t},callback:function(e){e.result&&(n[t]={result:e.result,timestamp:Date.now()/1e3|0},ctSetCookie("ct_checked_emails",JSON.stringify(n)))}}):"admin_ajax"===ctPublicFunctions.data__ajax_type&&apbct_public_sendAJAX({action:"apbct_email_check_before_post",email:t},{callback:function(e){e.result&&(n[t]={result:e.result,timestamp:Date.now()/1e3|0},ctSetCookie("ct_checked_emails",JSON.stringify(n)))}}))}function f(e){console.log("ctSetPixelImg call"),ctSetCookie("apbct_pixel_url",e),+ctPublic.pixel__enabled&&!document.getElementById("apbct_pixel")&&jQuery("body").append('<img alt="Cleantalk Pixel" id="apbct_pixel" style="display: none; left: 99999px;" src="'+e+'">')}s(window,"mousemove",m),s(window,"mousedown",u),s(window,"keydown",u),s(window,"scroll",function(){e||(ctSetCookie("ct_has_scrolled","true"),e=!0)}),s(window,"DOMContentLoaded",function(){console.log("apbct_ready call");var e=[["ct_ps_timestamp",Math.floor((new Date).getTime()/1e3)],["ct_fkp_timestamp","0"],["ct_pointer_data","0"],["ct_timezone",l.getTimezoneOffset()/60*-1],["ct_screen_info",apbctGetScreenInfo()],["ct_has_scrolled","false"],["ct_mouse_moved","false"],["apbct_headless",navigator.webdriver]];if("native"!==ctPublic.data__cookies_type)e.push(["apbct_visible_fields","0"]);else{var t=document.cookie.split(";");if(0!==t.length)for(var o=0;o<t.length;o++){var i=t[o].trim().split("=")[0];0===i.indexOf("apbct_visible_fields_")&&ctDeleteCookie(i)}}+ctPublic.pixel__setting&&(+ctPublic.pixel__enabled?function(){console.log("ctGetPixelUrl call");var e=ctGetPixelUrlLocalstorage();if(!1!==e){if(!ctIsOutdatedPixelUrlLocalstorage(e))return f(e);ctCleaPixelUrlLocalstorage()}console.log("Run AJAX to get pixel_url"),"rest"===ctPublicFunctions.data__ajax_type?apbct_public_sendREST("apbct_get_pixel_url",{method:"POST",callback:function(e){e&&(ctGetPixelUrlLocalstorage()||ctSetPixelUrlLocalstorage(e),f(e))}}):apbct_public_sendAJAX({action:"apbct_get_pixel_url"},{notJson:!0,callback:function(e){e&&(ctGetPixelUrlLocalstorage()||ctSetPixelUrlLocalstorage(e),f(e))}})}():e.push(["apbct_pixel_url",ctPublic.pixel__url])),+ctPublic.data__email_check_before_post&&(e.push(["ct_checked_emails","0"]),jQuery("input[type = 'email'], #email").blur(p)),ctSetCookie(e),setTimeout(function(){for(var e=0;e<document.forms.length;e++){var t,o,i=document.forms[e];0==+ctPublic.data__visible_fields_required||"get"===i.method.toString().toLowerCase()||i.classList.contains("slp_search_form")||i.parentElement.classList.contains("mec-booking")||-1!==i.action.toString().indexOf("activehosted.com")||i.id&&"caspioform"===i.id||i.classList&&i.classList.contains("tinkoffPayRow")||i.classList&&i.classList.contains("give-form")||i.id&&"ult-forgot-password-form"===i.id||i.id&&-1!==i.id.toString().indexOf("calculatedfields")||i.id&&-1!==i.id.toString().indexOf("sac-form")||i.id&&-1!==i.id.toString().indexOf("cp_tslotsbooking_pform")||i.name&&-1!==i.name.toString().indexOf("cp_tslotsbooking_pform")||"https://epayment.epymtservice.com/epay.jhtml"===i.action.toString()||((t=document.createElement("input")).setAttribute("type","hidden"),t.setAttribute("id","apbct_visible_fields_"+e),t.setAttribute("name","apbct_visible_fields"),(o={})[0]=apbct_collect_visible_fields(i),t.value=JSON.stringify(o),i.append(t),i.onsubmit_prev=i.onsubmit,i.ctFormIndex=e,i.onsubmit=function(e){var t;"native"!==ctPublic.data__cookies_type&&void 0!==e.target.ctFormIndex&&((t={})[0]=apbct_collect_visible_fields(this),apbct_visible_fields_set_cookie(t,e.target.ctFormIndex)),e.target.onsubmit_prev instanceof Function&&setTimeout(function(){e.target.onsubmit_prev.call(e.target,e)},500)})}},1e3)})}(),"undefined"!=typeof jQuery&&jQuery(document).ajaxComplete(function(e,t,o){t.responseText&&-1!==t.responseText.indexOf('"apbct')&&void 0!==(t=JSON.parse(t.responseText)).apbct&&(t=t.apbct).blocked&&(document.dispatchEvent(new CustomEvent("apbctAjaxBockAlert",{bubbles:!0,detail:{message:t.comment}})),cleantalkModal.loaded=t.comment,cleantalkModal.open(),1==+t.stop_script&&window.stop())});
//# sourceMappingURL=apbct-public.min.js.map
