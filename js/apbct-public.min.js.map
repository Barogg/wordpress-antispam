{"version":3,"sources":["apbct-public.js"],"names":["ctSetCookie","c_name","value","document","cookie","encodeURIComponent","apbct_collect_visible_fields_and_set_cookie","form","inputs","inputs_visible","inputs_visible_count","inputs_with_duplicate_names","key","elements","isNaN","filter","elem","getComputedStyle","display","visibility","opacity","getAttribute","indexOf","push","forEach","i","trim","apbct_js_keys__set_input_value","result","data","params","obj","getElementById","input_name","ct_input_value","replace","js_key","ct_date","Date","ctTimeMs","getTime","ctMouseEventTimerFlag","ctMouseData","ctMouseDataCounter","apbct_attach_event_handler","event","callback","window","addEventListener","attachEvent","apbct_remove_event_handler","removeEventListener","detachEvent","Math","floor","setTimeout","getTimezoneOffset","ctFunctionFirstKey","ctMouseReadInterval","setInterval","ctMouseWriteDataInterval","JSON","stringify","ctFunctionMouseMove","round","clientY","clientX","clearInterval","forms","length","classList","contains","parentElement","action","onsubmit_prev","onsubmit","preventDefault","this","target","Function","call","jQuery","apbct_sendAJAXRequest","callback_context","callback_params","notJson","timeout","async","ctCommon","_ajax_nonce","random","no_cache","ajax","type","url","_ajax_url","success","console","log","parse","error","apply","concat","jqXHR","textStatus","errorThrown","ajaxComplete","xhr","settings","responseText","response","apbct","blocked","alert","comment","stop_script","stop"],"mappings":"AA6HA,SAASA,YAAYC,EAAQC,GAC5BC,SAASC,OAASH,EAAS,IAAMI,mBAAmBH,GAAS,yBAG9D,SAASI,4CAA4CC,GAGpD,IAAIC,EAAS,GACZC,EAAiB,GACjBC,EAAuB,EACvBC,EAA8B,GAE/B,IAAI,IAAIC,KAAOL,EAAKM,SACfC,OAAOF,KACVJ,EAAOI,GAAOL,EAAKM,SAASD,KAI9BJ,EAASA,EAAOO,OAAO,SAASC,GAG/B,MAA0C,SAAtCC,iBAAiBD,GAAME,SACY,WAAtCD,iBAAiBD,GAAMG,YACe,MAAtCF,iBAAiBD,GAAMI,SACe,WAAtCJ,EAAKK,aAAa,SACoB,WAAtCL,EAAKK,aAAa,SACoB,KAAtCL,EAAKd,OACiC,OAAtCc,EAAKK,aAAa,UACoD,IAAtEV,EAA4BW,QAASN,EAAKK,aAAa,WAMxDX,KAGK,IAAM,CAAC,QAAS,YAAYY,QAASN,EAAKK,aAAa,WAC3DV,EAA4BY,KAAMP,EAAKK,aAAa,UAC7C,OAOFG,QAAQ,SAASR,EAAMS,EAAGZ,GAChCJ,GAAkB,IAAMO,EAAKK,aAAa,UAI3CrB,YAAY,uBAFZS,EAAiBA,EAAeiB,QAGhC1B,YAAY,6BAA8BU,GAI3C,SAASiB,+BAA+BC,EAAQC,EAAMC,EAAQC,GAC7D,GAAmD,OAA/C5B,SAAS6B,eAAeF,EAAOG,YAAsB,CACxD,IAAIC,EAAiB/B,SAAS6B,eAAeF,EAAOG,YAAY/B,MAChEC,SAAS6B,eAAeF,EAAOG,YAAY/B,MAAQC,SAAS6B,eAAeF,EAAOG,YAAY/B,MAAMiC,QAAQD,EAAgBN,EAAOQ,SAIrI,GA5LC,WAEA,IAAIC,EAAU,IAAIC,KACjBC,GAAW,IAAID,MAAOE,UACtBC,GAAwB,EACxBC,EAAc,GACdC,EAAqB,EAEtB,SAASC,EAA2B5B,EAAM6B,EAAOC,GACV,mBAA5BC,OAAOC,iBAAiChC,EAAKgC,iBAAiBH,EAAOC,GAC7B9B,EAAKiC,YAAYJ,EAAOC,GAG3E,SAASI,EAA2BlC,EAAM6B,EAAOC,GACP,mBAA/BC,OAAOI,oBAAoCnC,EAAKmC,oBAAoBN,EAAOC,GAChC9B,EAAKoC,YAAYP,EAAOC,GAG9E9C,YAAY,kBAAmBqD,KAAKC,OAAM,IAAIhB,MAAOE,UAAU,MAC/DxC,YAAY,mBAAoB,KAChCA,YAAY,kBAAmB,KAC/BA,YAAY,cAAe,KAE3BuD,WAAW,WACVvD,YAAY,cAAeqC,EAAQmB,oBAAoB,IAAK,IAC3D,KAGF,IAAIC,EAAqB,SAAgBZ,GAExC7C,YAAY,mBADOqD,KAAKC,OAAM,IAAIhB,MAAOE,UAAU,MA0CnDU,EAA2BH,OAAQ,YAAaU,GAChDP,EAA2BH,OAAQ,UAAWU,IArC3CC,EAAsBC,YAAY,WACrClB,GAAwB,GACtB,KAGCmB,EAA2BD,YAAY,WAC1C3D,YAAY,kBAAmB6D,KAAKC,UAAUpB,KAC5C,MAGCqB,EAAsB,SAAgBlB,IACZ,IAA1BJ,IAEFC,EAAYnB,KAAK,CAChB8B,KAAKW,MAAMnB,EAAMoB,SACjBZ,KAAKW,MAAMnB,EAAMqB,SACjBb,KAAKW,OAAM,IAAI1B,MAAOE,UAAYD,KAInCE,GAAwB,EACC,MAFzBE,IAUDO,EAA2BH,OAAQ,YAAagB,GAChDI,cAAcT,GACdS,cAAcP,MASfhB,EAA2BG,OAAQ,YAAagB,GAChDnB,EAA2BG,OAAQ,YAAaU,GAChDb,EAA2BG,OAAQ,UAAWU,GA4C9Cb,EAA2BG,OAAQ,mBAzCnC,WAEC/C,YAAY,uBAAwB,GACpCA,YAAY,6BAA8B,GAE1CuD,WAAW,WAEV,IAAI,IAAI9B,EAAI,EAAGA,EAAItB,SAASiE,MAAMC,OAAQ5C,IAAI,CAC7C,IAAIlB,EAAOJ,SAASiE,MAAM3C,GAIzBlB,EAAK+D,UAAUC,SAAS,oBACxBhE,EAAKiE,cAAcF,UAAUC,SAAS,gBACtCpE,SAASiE,MAAM3C,GAAGgD,OAAOnD,QAAQ,sBAKO,IAAxCmD,OAAOnD,QAAQ,sBAIff,EAAKmE,cAAgBnE,EAAKoE,SAC1BpE,EAAKoE,SAAW,SAAU9B,GAEzBA,EAAM+B,iBAENtE,4CAA4CuE,MAGxChC,EAAMiC,OAAOJ,yBAAyBK,UACzCxB,WAAW,WACVV,EAAMiC,OAAOJ,cAAcM,KAAKnC,EAAMiC,OAAQjC,IAC5C,SAKL,OAvHL,GA4LqB,oBAAXoC,OAAwB,CAiBjC,SAASC,sBAAsBrD,EAAMC,EAAQC,GAG5C,IAAIe,EAAWhB,EAAOgB,UAAY,KAC9BqC,EAAmBrD,EAAOqD,kBAAoB,KAC9CC,EAAkBtD,EAAOsD,iBAAmB,KAC5CC,EAAUvD,EAAOuD,SAAW,KAC5BC,EAAUxD,EAAOwD,SAAW,KAC5BC,EAAQzD,EAAOyD,QAAS,EACxBxD,EAAMA,GAAO,KAEI,iBAAX,EACTF,EAAOA,EAAO,gBAAkB2D,SAASC,YAAc,aAAepC,KAAKqC,UAE3E7D,EAAK4D,YAAcD,SAASC,YAC5B5D,EAAK8D,SAAWtC,KAAKqC,UAGtBT,OAAOW,KAAK,CACXC,KAAM,OACNC,IAAKN,SAASO,UACdlE,KAAMA,EACN0D,MAAOA,EACPS,QAAS,SAAUpE,GAElBqE,QAAQC,IAAItE,GAEPyD,IAASzD,EAASiC,KAAKsC,MAAMvE,IAC9BA,EAAOwE,OAINtD,IACCsC,EACHtC,EAASuD,MAAOlB,EAAkBC,EAAgBkB,OAAQ1E,EAAQC,EAAMC,EAAQC,IAEhFe,EAASlB,EAAQC,EAAMC,EAAQC,KAInCqE,MAAO,SAAUG,EAAOC,EAAYC,GACnCR,QAAQC,IAAI,oBACZD,QAAQC,IAAIrE,GACZoE,QAAQC,IAAIK,GACZN,QAAQC,IAAIM,GACZP,QAAQC,IAAIO,IAEbnB,QAASA,IA7DXL,OAAO9E,UAAUuG,aAAa,SAAU7D,EAAO8D,EAAKC,GACnD,GAAID,EAAIE,eAAwD,IAAxCF,EAAIE,aAAavF,QAAQ,UAAkB,CAClE,IAAIwF,EAAWjD,KAAKsC,MAAMQ,EAAIE,mBACA,IAAnBC,EAASC,QACnBD,EAAWA,EAASC,OACPC,UACZC,MAAMH,EAASI,SACa,IAAxBJ,EAASK,aACZpE,OAAOqE","file":"apbct-public.min.js","sourcesContent":["(function() {\n\n\tvar ct_date = new Date(),\n\t\tctTimeMs = new Date().getTime(),\n\t\tctMouseEventTimerFlag = true, //Reading interval flag\n\t\tctMouseData = [],\n\t\tctMouseDataCounter = 0;\n\n\tfunction apbct_attach_event_handler(elem, event, callback){\n\t\tif(typeof window.addEventListener === \"function\") elem.addEventListener(event, callback);\n\t\telse                                              elem.attachEvent(event, callback);\n\t}\n\n\tfunction apbct_remove_event_handler(elem, event, callback){\n\t\tif(typeof window.removeEventListener === \"function\") elem.removeEventListener(event, callback);\n\t\telse                                                 elem.detachEvent(event, callback);\n\t}\n\n\tctSetCookie(\"ct_ps_timestamp\", Math.floor(new Date().getTime()/1000));\n\tctSetCookie(\"ct_fkp_timestamp\", \"0\");\n\tctSetCookie(\"ct_pointer_data\", \"0\");\n\tctSetCookie(\"ct_timezone\", \"0\");\n\n\tsetTimeout(function(){\n\t\tctSetCookie(\"ct_timezone\", ct_date.getTimezoneOffset()/60*(-1));\n\t},1000);\n\n\t//Writing first key press timestamp\n\tvar ctFunctionFirstKey = function output(event){\n\t\tvar KeyTimestamp = Math.floor(new Date().getTime()/1000);\n\t\tctSetCookie(\"ct_fkp_timestamp\", KeyTimestamp);\n\t\tctKeyStopStopListening();\n\t};\n\n\t//Reading interval\n\tvar ctMouseReadInterval = setInterval(function(){\n\t\tctMouseEventTimerFlag = true;\n\t}, 150);\n\n\t//Writting interval\n\tvar ctMouseWriteDataInterval = setInterval(function(){\n\t\tctSetCookie(\"ct_pointer_data\", JSON.stringify(ctMouseData));\n\t}, 1200);\n\n\t//Logging mouse position each 150 ms\n\tvar ctFunctionMouseMove = function output(event){\n\t\tif(ctMouseEventTimerFlag === true){\n\n\t\t\tctMouseData.push([\n\t\t\t\tMath.round(event.clientY),\n\t\t\t\tMath.round(event.clientX),\n\t\t\t\tMath.round(new Date().getTime() - ctTimeMs)\n\t\t\t]);\n\n\t\t\tctMouseDataCounter++;\n\t\t\tctMouseEventTimerFlag = false;\n\t\t\tif(ctMouseDataCounter >= 50){\n\t\t\t\tctMouseStopData();\n\t\t\t}\n\t\t}\n\t};\n\n\t//Stop mouse observing function\n\tfunction ctMouseStopData(){\n\t\tapbct_remove_event_handler(window, \"mousemove\", ctFunctionMouseMove);\n\t\tclearInterval(ctMouseReadInterval);\n\t\tclearInterval(ctMouseWriteDataInterval);\n\t}\n\n\t//Stop key listening function\n\tfunction ctKeyStopStopListening(){\n\t\tapbct_remove_event_handler(window, \"mousedown\", ctFunctionFirstKey);\n\t\tapbct_remove_event_handler(window, \"keydown\", ctFunctionFirstKey);\n\t}\n\n\tapbct_attach_event_handler(window, \"mousemove\", ctFunctionMouseMove);\n\tapbct_attach_event_handler(window, \"mousedown\", ctFunctionFirstKey);\n\tapbct_attach_event_handler(window, \"keydown\", ctFunctionFirstKey);\n\n\t// Ready function\n\tfunction apbct_ready(){\n\n\t\tctSetCookie(\"apbct_visible_fields\", 0);\n\t\tctSetCookie(\"apbct_visible_fields_count\", 0);\n\n\t\tsetTimeout(function(){\n\n\t\t\tfor(var i = 0; i < document.forms.length; i++){\n\t\t\t\tvar form = document.forms[i];\n\n\t\t\t\t//Exclusion for forms\n\t\t\t\tif (\n\t\t\t\t\tform.classList.contains('slp_search_form') || //StoreLocatorPlus form\n\t\t\t\t\tform.parentElement.classList.contains('mec-booking') ||\n\t\t\t\t\tdocument.forms[i].action.indexOf('activehosted.com') // Active Campaign\n\t\t\t\t)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif(\n\t\t\t\t\taction.indexOf('activehosted.com') !== -1 // Exclusion for ActiveCampaign\n\n\t\t\t\t) {\n\n\t\t\t\t\tform.onsubmit_prev = form.onsubmit;\n\t\t\t\t\tform.onsubmit = function (event) {\n\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\tapbct_collect_visible_fields_and_set_cookie(this);\n\n\t\t\t\t\t\t// Call previous submit action\n\t\t\t\t\t\tif (event.target.onsubmit_prev instanceof Function) {\n\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\tevent.target.onsubmit_prev.call(event.target, event);\n\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}, 1000);\n\t}\n\tapbct_attach_event_handler(window, \"DOMContentLoaded\", apbct_ready);\n\n}());\n\nfunction ctSetCookie(c_name, value) {\n\tdocument.cookie = c_name + \"=\" + encodeURIComponent(value) + \"; path=/; samesite=lax\";\n}\n\nfunction apbct_collect_visible_fields_and_set_cookie(form ) {\n\n\t// Get only fields\n\tvar inputs = [],\n\t\tinputs_visible = '',\n\t\tinputs_visible_count = 0,\n\t\tinputs_with_duplicate_names = [];\n\n\tfor(var key in form.elements){\n\t\tif(!isNaN(+key))\n\t\t\tinputs[key] = form.elements[key];\n\t}\n\n\t// Filter fields\n\tinputs = inputs.filter(function(elem){\n\n\t\t// Filter fields\n\t\tif( getComputedStyle(elem).display    === \"none\" ||   // hidden\n\t\t\tgetComputedStyle(elem).visibility === \"hidden\" || // hidden\n\t\t\tgetComputedStyle(elem).opacity    === \"0\" ||      // hidden\n\t\t\telem.getAttribute(\"type\")         === \"hidden\" || // type == hidden\n\t\t\telem.getAttribute(\"type\")         === \"submit\" || // type == submit\n\t\t\telem.value                        === \"\"       || // empty value\n\t\t\telem.getAttribute('name')         === null ||\n\t\t\tinputs_with_duplicate_names.indexOf( elem.getAttribute('name') ) !== -1 // name already added\n\t\t){\n\t\t\treturn false;\n\t\t}\n\n\t\t// Visible fields count\n\t\tinputs_visible_count++;\n\n\t\t// Filter inputs with same names for type == radio\n\t\tif( -1 !== ['radio', 'checkbox'].indexOf( elem.getAttribute(\"type\") )){\n\t\t\tinputs_with_duplicate_names.push( elem.getAttribute('name') );\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\t// Visible fields\n\tinputs.forEach(function(elem, i, elements){\n\t\tinputs_visible += \" \" + elem.getAttribute(\"name\");\n\t});\n\tinputs_visible = inputs_visible.trim();\n\n\tctSetCookie(\"apbct_visible_fields\", inputs_visible);\n\tctSetCookie(\"apbct_visible_fields_count\", inputs_visible_count);\n\n}\n\nfunction apbct_js_keys__set_input_value(result, data, params, obj){\n\tif (document.getElementById(params.input_name) !== null) {\n\t\tvar ct_input_value = document.getElementById(params.input_name).value;\n\t\tdocument.getElementById(params.input_name).value = document.getElementById(params.input_name).value.replace(ct_input_value, result.js_key);\n\t}\n}\n\nif(typeof jQuery !== 'undefined') {\n\n\t// Capturing responses and output block message for unknown AJAX forms\n\tjQuery(document).ajaxComplete(function (event, xhr, settings) {\n\t\tif (xhr.responseText && xhr.responseText.indexOf('\"apbct') !== -1) {\n\t\t\tvar response = JSON.parse(xhr.responseText);\n\t\t\tif (typeof response.apbct !== 'undefined') {\n\t\t\t\tresponse = response.apbct;\n\t\t\t\tif (response.blocked) {\n\t\t\t\t\talert(response.comment);\n\t\t\t\t\tif(+response.stop_script == 1)\n\t\t\t\t\t\twindow.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction apbct_sendAJAXRequest(data, params, obj) {\n\n\t\t// Default params\n\t\tvar callback = params.callback || null;\n\t\tvar callback_context = params.callback_context || null;\n\t\tvar callback_params = params.callback_params || null;\n\t\tvar notJson = params.notJson || null;\n\t\tvar timeout = params.timeout || 15000;\n\t\tvar async = params.async || true;\n\t\tvar obj = obj || null;\n\n\t\tif(typeof (data) === 'string') {\n\t\t\tdata = data + '&_ajax_nonce=' + ctCommon._ajax_nonce + '&no_cache=' + Math.random();\n\t\t}else{\n\t\t\tdata._ajax_nonce = ctCommon._ajax_nonce;\n\t\t\tdata.no_cache = Math.random();\n\t\t}\n\n\t\tjQuery.ajax({\n\t\t\ttype: \"POST\",\n\t\t\turl: ctCommon._ajax_url,\n\t\t\tdata: data,\n\t\t\tasync: async,\n\t\t\tsuccess: function (result) {\n\n\t\t\t\tconsole.log(result);\n\n\t\t\t\tif (!notJson) result = JSON.parse(result);\n\t\t\t\tif (result.error) {\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tif (callback_params)\n\t\t\t\t\t\t\tcallback.apply( callback_context, callback_params.concat( result, data, params, obj ) );\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcallback(result, data, params, obj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (jqXHR, textStatus, errorThrown) {\n\t\t\t\tconsole.log('APBCT_AJAX_ERROR');\n\t\t\t\tconsole.log(data);\n\t\t\t\tconsole.log(jqXHR);\n\t\t\t\tconsole.log(textStatus);\n\t\t\t\tconsole.log(errorThrown);\n\t\t\t},\n\t\t\ttimeout: timeout\n\t\t});\n\t}\n}"]}