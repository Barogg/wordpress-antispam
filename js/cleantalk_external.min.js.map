{"version":3,"file":"cleantalk_external.min.js","sources":["cleantalk_external.js"],"sourcesContent":["function ct_protect_external(){\r\n\r\n\tfor(var i = 0; i < document.forms.length; i++){\r\n\r\n\t\tif (document.forms[i].cleantalk_hidden_action == undefined && document.forms[i].cleantalk_hidden_method == undefined) {\r\n\r\n\t\t\tif(typeof(document.forms[i].action) == 'string'){\r\n\r\n\t\t\t\tvar action = document.forms[i].action;\r\n\r\n\t\t\t\t// Fix for ActiveCampaign form\r\n\t\t\t\tif(\r\n\t\t\t\t\taction.indexOf('activehosted.com') !== -1 ||\r\n\t\t\t\t\taction.indexOf('app.convertkit.com') !== -1\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tjQuery( document.forms[i] ).before('<i class=\"cleantalk_placeholder\" style=\"display: none;\"></i>')\r\n\r\n\t\t\t\t\t// Deleting form to prevent submit event\r\n\t\t\t\t\tvar prev = jQuery(document.forms[i]).prev(),\r\n\t\t\t\t\t\tform_html = document.forms[i].outerHTML,\r\n\t\t\t\t\t\tform_original = jQuery(document.forms[i]).detach(),\r\n\t\t\t\t\t\tindex = i;\r\n\r\n\t\t\t\t\tprev.after( form_html );\r\n\r\n\t\t\t\t\tvar force_action = document.createElement(\"input\");\r\n\t\t\t\t\tforce_action.name = 'action';\r\n\t\t\t\t\tforce_action.value = 'cleantalk_force_ajax_check';\r\n\t\t\t\t\tforce_action.type = 'hidden';\r\n\t\t\t\t\tdocument.forms[i].appendChild(force_action);\r\n\r\n\t\t\t\t\tdocument.forms[i].onsubmit = function ( event ){\r\n\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\t\t// Get visible fields and set cookie\r\n\t\t\t\t\t\tvar visible_fields = {};\r\n\t\t\t\t\t\tvisible_fields[0] = apbct_collect_visible_fields(this);\r\n\t\t\t\t\t\tapbct_visible_fields_set_cookie( visible_fields );\r\n\r\n\t\t\t\t\t\tvar data = jQuery(event.target).serialize();\r\n\r\n\t\t\t\t\t\tapbct_public_sendAJAX(\r\n\t\t\t\t\t\t\tdata,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tasync: true,\r\n\t\t\t\t\t\t\t\tcallback: function( index, prev, form_original, result ){\r\n\r\n\t\t\t\t\t\t\t\t\tif( ! +result.apbct.blocked ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar form_new = jQuery(document.forms[index]).detach();\r\n\r\n\t\t\t\t\t\t\t\t\t\tapbct_replace_inputs_values_from_other_form(form_new, form_original);\r\n\r\n\t\t\t\t\t\t\t\t\t\tprev.after(form_original);\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Common click event\r\n\t\t\t\t\t\t\t\t\t\tvar subm_button = jQuery(document.forms[index]).find('button[type=submit]');\r\n\t\t\t\t\t\t\t\t\t\tif( subm_button.length !== 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\tsubm_button[0].click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// ConvertKit direct integration\r\n\t\t\t\t\t\t\t\t\t\tsubm_button = jQuery(document.forms[index]).find('button[data-element=\"submit\"]');\r\n\t\t\t\t\t\t\t\t\t\tif( subm_button.length !== 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\tsubm_button[0].click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcallback_context: null,\r\n\t\t\t\t\t\t\t\tcallback_params: [index, prev, form_original],\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t// Common flow\r\n\t\t\t\t}else if(action.indexOf('http://') !== -1 || action.indexOf('https://') !== -1){\r\n\r\n\t\t\t\t\tvar tmp = action.split('//');\r\n\t\t\t\t\ttmp = tmp[1].split('/');\r\n\t\t\t\t\tvar host = tmp[0].toLowerCase();\r\n\r\n\t\t\t\t\tif(host !== location.hostname.toLowerCase()){\r\n\r\n\t                    var ct_action = document.createElement(\"input\");\r\n\t                    ct_action.name = 'cleantalk_hidden_action';\r\n\t\t\t\t\t\tct_action.value = action;\r\n\t\t\t\t\t\tct_action.type = 'hidden';\r\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_action);\r\n\r\n\t                    var ct_method = document.createElement(\"input\");\r\n\t                    ct_method.name = 'cleantalk_hidden_method';\r\n\t\t\t\t\t\tct_method.value = document.forms[i].method;\r\n\t\t\t\t\t\tct_method.type = 'hidden';\r\n\r\n\t\t\t\t\t\tdocument.forms[i].method = 'POST';\r\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_method);\r\n\r\n\t\t\t\t\t\tdocument.forms[i].action = document.location;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction apbct_replace_inputs_values_from_other_form( form_source, form_target ){\r\n\r\n\tvar\tinputs_source = jQuery( form_source ).find( 'button, input, textarea, select' ),\r\n\t\tinputs_target = jQuery( form_target ).find( 'button, input, textarea, select' );\r\n\r\n\tinputs_source.each( function( index, elem_source ){\r\n\r\n\t\tvar source = jQuery( elem_source );\r\n\r\n\t\tinputs_target.each( function( index2, elem_target ){\r\n\r\n\t\t\tvar target = jQuery( elem_target );\r\n\r\n\t\t\tif( elem_source.outerHTML === elem_target.outerHTML ){\r\n\r\n\t\t\t\ttarget.val( source.val() );\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n}\r\nwindow.onload = function () {\r\n    setTimeout(function () {\r\n        ct_protect_external()\r\n    }, 1500);\r\n};"],"names":["ct_protect_external","action","prev","form_html","form_original","index","force_action","ct_action","ct_method","i","document","forms","length","undefined","cleantalk_hidden_action","cleantalk_hidden_method","indexOf","jQuery","before","outerHTML","detach","after","createElement","name","value","type","appendChild","onsubmit","event","preventDefault","visible_fields","apbct_collect_visible_fields","this","apbct_visible_fields_set_cookie","data","target","serialize","apbct_public_sendAJAX","async","callback","result","subm_button","apbct","blocked","apbct_replace_inputs_values_from_other_form","find","click","callback_context","callback_params","split","toLowerCase","location","hostname","method","form_source","form_target","inputs_source","inputs_target","each","elem_source","source","index2","elem_target","val","window","onload","setTimeout"],"mappings":"AAAA,SAASA,sBAER,IAAI,IAMGC,EAWCC,EACHC,EACAC,EACAC,EAIGC,EA6DgBC,EAMAC,EA3FhBC,EAAI,EAAGA,EAAIC,SAASC,MAAMC,OAAQH,IAAI,CAEII,MAA7CH,SAASC,MAAMF,GAAGK,yBAAqFD,MAA7CH,SAASC,MAAMF,GAAGM,yBAExC,iBAA7BL,SAASC,MAAMF,GAAS,UAMQ,KAJrCR,EAASS,SAASC,MAAMF,GAAGR,QAIvBe,QAAQ,sBAC2B,IAA1Cf,EAAOe,QAAQ,uBAGfC,OAAQP,SAASC,MAAMF,IAAKS,OAAO,gEAG/BhB,EAAOe,OAAOP,SAASC,MAAMF,IAAIP,OACpCC,EAAYO,SAASC,MAAMF,GAAGU,UAC9Bf,EAAgBa,OAAOP,SAASC,MAAMF,IAAIW,SAC1Cf,EAAQI,EAETP,EAAKmB,MAAOlB,IAERG,EAAeI,SAASY,cAAc,UAC7BC,KAAO,SACpBjB,EAAakB,MAAQ,6BACrBlB,EAAamB,KAAO,SACpBf,SAASC,MAAMF,GAAGiB,YAAYpB,GAE9BI,SAASC,MAAMF,GAAGkB,SAAW,SAAWC,GAEvCA,EAAMC,iBAGN,IAAIC,EAAiB,GACrBA,EAAe,GAAKC,6BAA6BC,MACjDC,gCAAiCH,GAEjC,IAAII,EAAOjB,OAAOW,EAAMO,QAAQC,YAEhCC,sBACCH,EACA,CACCI,OAAO,EACPC,SAAU,SAAUlC,EAAOH,EAAME,EAAeoC,GAE/C,IASKC,GATED,EAAOE,MAAMC,UAInBC,4CAFe3B,OAAOP,SAASC,MAAMN,IAAQe,SAEShB,GAEtDF,EAAKmB,MAAMjB,GAIgB,KADvBqC,EAAcxB,OAAOP,SAASC,MAAMN,IAAQwC,KAAK,wBACrCjC,QACf6B,EAAY,GAAGK,QAKW,KAD3BL,EAAcxB,OAAOP,SAASC,MAAMN,IAAQwC,KAAK,kCACjCjC,QACf6B,EAAY,GAAGK,UAKlBC,iBAAkB,KAClBC,gBAAiB,CAAC3C,EAAOH,EAAME,QAOK,IAA/BH,EAAOe,QAAQ,aAAqD,IAAhCf,EAAOe,QAAQ,aAEjDf,EAAOgD,MAAM,MACb,GAAGA,MAAM,KACJ,GAAGC,gBAENC,SAASC,SAASF,iBAEV3C,EAAYG,SAASY,cAAc,UAC7BC,KAAO,0BAChChB,EAAUiB,MAAQvB,EAClBM,EAAUkB,KAAO,SACjBf,SAASC,MAAMF,GAAGiB,YAAYnB,IAEXC,EAAYE,SAASY,cAAc,UAC7BC,KAAO,0BAChCf,EAAUgB,MAAQd,SAASC,MAAMF,GAAG4C,OACpC7C,EAAUiB,KAAO,SAEjBf,SAASC,MAAMF,GAAG4C,OAAS,OAC3B3C,SAASC,MAAMF,GAAGiB,YAAYlB,GAE9BE,SAASC,MAAMF,GAAGR,OAASS,SAASyC,YAO1C,SAASP,4CAA6CU,EAAaC,GAElE,IAAIC,EAAgBvC,OAAQqC,GAAcT,KAAM,mCAC/CY,EAAgBxC,OAAQsC,GAAcV,KAAM,mCAE7CW,EAAcE,KAAM,SAAUrD,EAAOsD,GAEpC,IAAIC,EAAS3C,OAAQ0C,GAErBF,EAAcC,KAAM,SAAUG,EAAQC,GAErC,IAAI3B,EAASlB,OAAQ6C,GAEjBH,EAAYxC,YAAc2C,EAAY3C,WAEzCgB,EAAO4B,IAAKH,EAAOG,WAMvBC,OAAOC,OAAS,WACZC,WAAW,WACPlE,uBACD"}