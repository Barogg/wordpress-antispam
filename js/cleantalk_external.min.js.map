{"version":3,"file":"cleantalk_external.min.js","sources":["cleantalk_external.js"],"sourcesContent":["function ct_protect_external(){\r\n\r\n\tfor(var i = 0; i < document.forms.length; i++){\r\n\r\n\t\tif (document.forms[i].cleantalk_hidden_action == undefined && document.forms[i].cleantalk_hidden_method == undefined) {\r\n\r\n\t\t\tif(typeof(document.forms[i].action) == 'string'){\r\n\r\n\t\t\t\tvar action = document.forms[i].action;\r\n\r\n\t\t\t\t// Fix for ActiveCampaign form\r\n\t\t\t\tif(\r\n\t\t\t\t\taction.indexOf('activehosted.com') !== -1 ||\r\n\t\t\t\t\taction.indexOf('app.convertkit.com') !== -1\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tjQuery( document.forms[i] ).before('<i class=\"cleantalk_placeholder\" style=\"display: none;\"></i>')\r\n\r\n\t\t\t\t\t// Deleting form to prevent submit event\r\n\t\t\t\t\tvar prev = jQuery(document.forms[i]).prev(),\r\n\t\t\t\t\t\tform_html = document.forms[i].outerHTML,\r\n\t\t\t\t\t\tform_original = jQuery(document.forms[i]).detach(),\r\n\t\t\t\t\t\tindex = i;\r\n\r\n\t\t\t\t\tprev.after( form_html );\r\n\r\n\t\t\t\t\tvar force_action = document.createElement(\"input\");\r\n\t\t\t\t\tforce_action.name = 'action';\r\n\t\t\t\t\tforce_action.value = 'cleantalk_force_ajax_check';\r\n\t\t\t\t\tforce_action.type = 'hidden';\r\n\t\t\t\t\tdocument.forms[i].appendChild(force_action);\r\n\r\n\t\t\t\t\tdocument.forms[i].onsubmit = function ( event ){\r\n\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\t\t// Get visible fields and set cookie\r\n\t\t\t\t\t\tapbct_collect_visible_fields_and_set_cookie(this);\r\n\r\n\t\t\t\t\t\tvar data = jQuery(event.target).serialize();\r\n\r\n\t\t\t\t\t\tapbct_sendAJAXRequest(\r\n\t\t\t\t\t\t\tdata,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tasync: true,\r\n\t\t\t\t\t\t\t\tcallback: function( index, prev, form_original, result ){\r\n\r\n\t\t\t\t\t\t\t\t\tif( ! +result.apbct.blocked ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar form_new = jQuery(document.forms[index]).detach();\r\n\r\n\t\t\t\t\t\t\t\t\t\tapbct_replace_inputs_values_from_other_form(form_new, form_original);\r\n\r\n\t\t\t\t\t\t\t\t\t\tprev.after(form_original);\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Common click event\r\n\t\t\t\t\t\t\t\t\t\tvar subm_button = jQuery(document.forms[index]).find('button[type=submit]');\r\n\t\t\t\t\t\t\t\t\t\tif( subm_button.length !== 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\tsubm_button[0].click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// ConvertKit direct integration\r\n\t\t\t\t\t\t\t\t\t\tsubm_button = jQuery(document.forms[index]).find('button[data-element=\"submit\"]');\r\n\t\t\t\t\t\t\t\t\t\tif( subm_button.length !== 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\tsubm_button[0].click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcallback_context: null,\r\n\t\t\t\t\t\t\t\tcallback_params: [index, prev, form_original],\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t// Common flow\r\n\t\t\t\t}else if(action.indexOf('http://') !== -1 || action.indexOf('https://') !== -1){\r\n\r\n\t\t\t\t\tvar tmp = action.split('//');\r\n\t\t\t\t\ttmp = tmp[1].split('/');\r\n\t\t\t\t\tvar host = tmp[0].toLowerCase();\r\n\r\n\t\t\t\t\tif(host !== location.hostname.toLowerCase()){\r\n\r\n\t                    var ct_action = document.createElement(\"input\");\r\n\t                    ct_action.name = 'cleantalk_hidden_action';\r\n\t\t\t\t\t\tct_action.value = action;\r\n\t\t\t\t\t\tct_action.type = 'hidden';\r\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_action);\r\n\r\n\t                    var ct_method = document.createElement(\"input\");\r\n\t                    ct_method.name = 'cleantalk_hidden_method';\r\n\t\t\t\t\t\tct_method.value = document.forms[i].method;\r\n\t\t\t\t\t\tct_method.type = 'hidden';\r\n\r\n\t\t\t\t\t\tdocument.forms[i].method = 'POST';\r\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_method);\r\n\r\n\t\t\t\t\t\tdocument.forms[i].action = document.location;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nwindow.onload = function () {\r\n    setTimeout(function () {\r\n        ct_protect_external()\r\n    }, 1500);\r\n};"],"names":["ct_protect_external","action","prev","form_html","form_original","index","force_action","ct_action","ct_method","i","document","forms","length","undefined","cleantalk_hidden_action","cleantalk_hidden_method","indexOf","jQuery","before","outerHTML","detach","after","createElement","name","value","type","appendChild","onsubmit","event","preventDefault","apbct_collect_visible_fields_and_set_cookie","this","data","target","serialize","apbct_sendAJAXRequest","async","callback","result","form_new","subm_button","apbct","blocked","apbct_replace_inputs_values_from_other_form","find","click","callback_context","callback_params","split","toLowerCase","location","hostname","method","window","onload","setTimeout"],"mappings":"AAAA,SAASA,sBAER,IAAI,IAMGC,EAWCC,EACHC,EACAC,EACAC,EAIGC,EA2DgBC,EAMAC,EAzFhBC,EAAI,EAAGA,EAAIC,SAASC,MAAMC,OAAQH,IAAI,CAEII,MAA7CH,SAASC,MAAMF,GAAGK,yBAAqFD,MAA7CH,SAASC,MAAMF,GAAGM,yBAExC,iBAA7BL,SAASC,MAAMF,GAAS,UAMQ,KAJrCR,EAASS,SAASC,MAAMF,GAAGR,QAIvBe,QAAQ,sBAC2B,IAA1Cf,EAAOe,QAAQ,uBAGfC,OAAQP,SAASC,MAAMF,IAAKS,OAAO,gEAG/BhB,EAAOe,OAAOP,SAASC,MAAMF,IAAIP,OACpCC,EAAYO,SAASC,MAAMF,GAAGU,UAC9Bf,EAAgBa,OAAOP,SAASC,MAAMF,IAAIW,SAC1Cf,EAAQI,EAETP,EAAKmB,MAAOlB,IAERG,EAAeI,SAASY,cAAc,UAC7BC,KAAO,SACpBjB,EAAakB,MAAQ,6BACrBlB,EAAamB,KAAO,SACpBf,SAASC,MAAMF,GAAGiB,YAAYpB,GAE9BI,SAASC,MAAMF,GAAGkB,SAAW,SAAWC,GAEvCA,EAAMC,iBAGNC,4CAA4CC,MAE5C,IAAIC,EAAOf,OAAOW,EAAMK,QAAQC,YAEhCC,sBACCH,EACA,CACCI,OAAO,EACPC,SAAU,SAAUhC,EAAOH,EAAME,EAAekC,GAE/C,IAEKC,EAOAC,GATEF,EAAOG,MAAMC,UAEfH,EAAWtB,OAAOP,SAASC,MAAMN,IAAQe,SAE7CuB,4CAA4CJ,EAAUnC,GAEtDF,EAAKmB,MAAMjB,GAIgB,KADvBoC,EAAcvB,OAAOP,SAASC,MAAMN,IAAQuC,KAAK,wBACrChC,QACf4B,EAAY,GAAGK,QAKW,KAD3BL,EAAcvB,OAAOP,SAASC,MAAMN,IAAQuC,KAAK,kCACjChC,QACf4B,EAAY,GAAGK,UAKlBC,iBAAkB,KAClBC,gBAAiB,CAAC1C,EAAOH,EAAME,QAOK,IAA/BH,EAAOe,QAAQ,aAAqD,IAAhCf,EAAOe,QAAQ,aAEjDf,EAAO+C,MAAM,MACb,GAAGA,MAAM,KACJ,GAAGC,gBAENC,SAASC,SAASF,iBAEV1C,EAAYG,SAASY,cAAc,UAC7BC,KAAO,0BAChChB,EAAUiB,MAAQvB,EAClBM,EAAUkB,KAAO,SACjBf,SAASC,MAAMF,GAAGiB,YAAYnB,IAEXC,EAAYE,SAASY,cAAc,UAC7BC,KAAO,0BAChCf,EAAUgB,MAAQd,SAASC,MAAMF,GAAG2C,OACpC5C,EAAUiB,KAAO,SAEjBf,SAASC,MAAMF,GAAG2C,OAAS,OAC3B1C,SAASC,MAAMF,GAAGiB,YAAYlB,GAE9BE,SAASC,MAAMF,GAAGR,OAASS,SAASwC,YAQ1CG,OAAOC,OAAS,WACZC,WAAW,WACPvD,uBACD"}