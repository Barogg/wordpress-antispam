{"version":3,"sources":["cleantalk_external.js"],"names":["ct_protect_external","i","document","forms","length","undefined","cleantalk_hidden_action","cleantalk_hidden_method","action","indexOf","prev","jQuery","form_html","outerHTML","form_original","detach","index","after","force_action","createElement","name","value","type","appendChild","onsubmit","event","preventDefault","apbct_collect_visible_fields_and_set_cookie","this","data","serialize","target","apbct_sendAJAXRequest","async","callback","result","apbct","blocked","form_new","apbct_replace_inputs_values_from_other_form","find","click","callback_context","callback_params","tmp","split","toLowerCase","location","hostname","ct_action","ct_method","method","window","onload","setTimeout"],"mappings":"AAAA,SAASA,sBAER,IAAI,IAAIC,EAAI,EAAGA,EAAIC,SAASC,MAAMC,OAAQH,IAEzC,GAAiDI,MAA7CH,SAASC,MAAMF,GAAGK,yBAAqFD,MAA7CH,SAASC,MAAMF,GAAGM,yBAExC,iBAA7BL,SAASC,MAAMF,GAAS,OAAc,CAE/C,IAAIO,EAASN,SAASC,MAAMF,GAAGO,OAG/B,IAA2C,IAAxCA,EAAOC,QAAQ,oBAA4B,CAG7C,IAAIC,EAAOC,OAAOT,SAASC,MAAMF,IAAIS,OACpCE,EAAYV,SAASC,MAAMF,GAAGY,UAC9BC,EAAgBH,OAAOT,SAASC,MAAMF,IAAIc,SAC1CC,EAAQf,EAETS,EAAKO,MAAOL,GAEZ,IAAIM,EAAehB,SAASiB,cAAc,SAC1CD,EAAaE,KAAO,SACpBF,EAAaG,MAAQ,6BACrBH,EAAaI,KAAO,SACpBpB,SAASC,MAAMF,GAAGsB,YAAYL,GAE9BhB,SAASC,MAAMF,GAAGuB,SAAW,SAAWC,GAEvCA,EAAMC,iBAGNC,4CAA4CC,MAE5C,IAAIC,EAAOC,UAAWL,EAAMM,QAE5BC,sBACCH,EACA,CACCI,OAAO,EACPC,SAAU,SAAUlB,EAAON,EAAMI,EAAeqB,GAE/C,KAAOA,EAAOC,MAAMC,QAAU,CAE7B,IAAIC,EAAW3B,OAAOT,SAASC,MAAMa,IAAQD,SAE7CwB,4CAA4CD,EAAUxB,GAEtDJ,EAAKO,MAAMH,GAEXH,OAAOT,SAASC,MAAMa,IAAQwB,KAAK,uBAAuB,GAAGC,UAG/DC,iBAAkB,KAClBC,gBAAiB,CAAC3B,EAAON,EAAMI,WAO7B,IAAkC,IAA/BN,EAAOC,QAAQ,aAAqD,IAAhCD,EAAOC,QAAQ,YAAmB,CAE9E,IAAImC,EAAMpC,EAAOqC,MAAM,MAIvB,IAHAD,EAAMA,EAAI,GAAGC,MAAM,MACJ,GAAGC,gBAENC,SAASC,SAASF,cAAc,CAE5B,IAAIG,EAAY/C,SAASiB,cAAc,SACvC8B,EAAU7B,KAAO,0BAChC6B,EAAU5B,MAAQb,EAClByC,EAAU3B,KAAO,SACjBpB,SAASC,MAAMF,GAAGsB,YAAY0B,GAEf,IAAIC,EAAYhD,SAASiB,cAAc,SACvC+B,EAAU9B,KAAO,0BAChC8B,EAAU7B,MAAQnB,SAASC,MAAMF,GAAGkD,OACpCD,EAAU5B,KAAO,SAEjBpB,SAASC,MAAMF,GAAGkD,OAAS,OAC3BjD,SAASC,MAAMF,GAAGsB,YAAY2B,GAE9BhD,SAASC,MAAMF,GAAGO,OAASN,SAAS6C,YAQ1CK,OAAOC,OAAS,WACZC,WAAW,WACPtD,uBACD","file":"cleantalk_external.min.js","sourcesContent":["function ct_protect_external(){\n\n\tfor(var i = 0; i < document.forms.length; i++){\n\n\t\tif (document.forms[i].cleantalk_hidden_action == undefined && document.forms[i].cleantalk_hidden_method == undefined) {\n\n\t\t\tif(typeof(document.forms[i].action) == 'string'){\n\n\t\t\t\tvar action = document.forms[i].action;\n\n\t\t\t\t// Fix for ActiveCampaign form\n\t\t\t\tif(action.indexOf('activehosted.com') !== -1) {\n\n\t\t\t\t\t// Deleting form to prevent submit event\n\t\t\t\t\tvar prev = jQuery(document.forms[i]).prev(),\n\t\t\t\t\t\tform_html = document.forms[i].outerHTML,\n\t\t\t\t\t\tform_original = jQuery(document.forms[i]).detach(),\n\t\t\t\t\t\tindex = i;\n\n\t\t\t\t\tprev.after( form_html );\n\n\t\t\t\t\tvar force_action = document.createElement(\"input\");\n\t\t\t\t\tforce_action.name = 'action';\n\t\t\t\t\tforce_action.value = 'cleantalk_force_ajax_check';\n\t\t\t\t\tforce_action.type = 'hidden';\n\t\t\t\t\tdocument.forms[i].appendChild(force_action);\n\n\t\t\t\t\tdocument.forms[i].onsubmit = function ( event ){\n\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Get visible fields and set cookie\n\t\t\t\t\t\tapbct_collect_visible_fields_and_set_cookie(this);\n\n\t\t\t\t\t\tvar data = serialize( event.target );\n\n\t\t\t\t\t\tapbct_sendAJAXRequest(\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tasync: true,\n\t\t\t\t\t\t\t\tcallback: function( index, prev, form_original, result ){\n\n\t\t\t\t\t\t\t\t\tif( ! +result.apbct.blocked ) {\n\n\t\t\t\t\t\t\t\t\t\tvar form_new = jQuery(document.forms[index]).detach();\n\n\t\t\t\t\t\t\t\t\t\tapbct_replace_inputs_values_from_other_form(form_new, form_original);\n\n\t\t\t\t\t\t\t\t\t\tprev.after(form_original);\n\n\t\t\t\t\t\t\t\t\t\tjQuery(document.forms[index]).find('button[type=submit]')[0].click();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcallback_context: null,\n\t\t\t\t\t\t\t\tcallback_params: [index, prev, form_original],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t};\n\n\t\t\t\t// Common flow\n\t\t\t\t}else if(action.indexOf('http://') !== -1 || action.indexOf('https://') !== -1){\n\n\t\t\t\t\tvar tmp = action.split('//');\n\t\t\t\t\ttmp = tmp[1].split('/');\n\t\t\t\t\tvar host = tmp[0].toLowerCase();\n\n\t\t\t\t\tif(host !== location.hostname.toLowerCase()){\n\n\t                    var ct_action = document.createElement(\"input\");\n\t                    ct_action.name = 'cleantalk_hidden_action';\n\t\t\t\t\t\tct_action.value = action;\n\t\t\t\t\t\tct_action.type = 'hidden';\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_action);\n\n\t                    var ct_method = document.createElement(\"input\");\n\t                    ct_method.name = 'cleantalk_hidden_method';\n\t\t\t\t\t\tct_method.value = document.forms[i].method;\n\t\t\t\t\t\tct_method.type = 'hidden';\n\n\t\t\t\t\t\tdocument.forms[i].method = 'POST';\n\t\t\t\t\t\tdocument.forms[i].appendChild(ct_method);\n\n\t\t\t\t\t\tdocument.forms[i].action = document.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nwindow.onload = function () {\n    setTimeout(function () {\n        ct_protect_external()\n    }, 1500);\n};"]}