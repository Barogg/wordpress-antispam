{"version":3,"file":"cleantalk-admin.min.js","sources":["cleantalk-admin.js"],"sourcesContent":["jQuery(document).ready(function($){\r\n\t\r\n\t// Auto update banner close handler\r\n\tjQuery('.apbct_update_notice').on('click', 'button', function(){\r\n\t\tvar ct_date = new Date(new Date().getTime() + 1000 * 86400 * 30 );\r\n\t\tvar ctSecure = location.protocol === 'https:' ? '; secure' : '';\r\n\t\tdocument.cookie = \"apbct_update_banner_closed=1; path=/; expires=\" + ct_date.toUTCString() + \"; samesite=lax\" + ctSecure;\r\n\t});\r\n\t\r\n\tjQuery('li a[href=\"options-general.php?page=cleantalk\"]').css('white-space','nowrap').css('display','inline-block');\r\n\r\n\tjQuery('body').on('click', '.apbct-notice .notice-dismiss', function(e){\r\n\t\tvar apbct_notice_name = jQuery(e.target).parent().attr('id');\r\n\t\tif( apbct_notice_name ) {\r\n\t\t\tapbct_admin_sendAJAX( { 'action' : 'cleantalk_dismiss_notice', 'notice_id' : apbct_notice_name }, { 'callback' : null, 'notJson': true } );\r\n\t\t}\r\n\t});\r\n\r\n\tjQuery('body').on('click', '.apbct-notice .notice-dismiss-link', function(e){\r\n\t\tvar apbct_notice_name = jQuery(e.target).parent().attr('id');\r\n\t\tif( apbct_notice_name ) {\r\n\t\t\tapbct_admin_sendAJAX( { 'action' : 'cleantalk_dismiss_notice', 'notice_id' : apbct_notice_name }, { 'callback' : null, 'notJson': true } );\r\n\t\t\tjQuery(e.target).parent().closest('.apbct-notice').fadeOut(500);\r\n\t\t}\r\n\t});\r\n\r\n\t// Notice when deleting user\r\n\tjQuery('.ct_username .row-actions .delete a').on('click', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet result = confirm(ctAdminCommon.notice_when_deleting_user_text);\r\n\r\n\t\tif (result) {\r\n\t\t\twindow.location = this.href\r\n\t\t}\r\n\t});\r\n\r\n\t// Restore spam order\r\n\t$('.apbct-restore-spam-order-button').click(function () {\r\n\t\tconst spmOrderId = $(this).data('spam-order-id');\r\n\t\tlet data = {\r\n\t\t\taction: 'apbct_restore_spam_order',\r\n\t\t\t_ajax_nonce: ctAdminCommon._ajax_nonce,\r\n\t\t\torder_id: spmOrderId\r\n\t\t};\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: ctAdminCommon._ajax_url,\r\n\t\t\tdata: data,\r\n\t\t\tsuccess: function(result){\r\n\t\t\t\tif (result.success) {\r\n\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(result.data.message)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t});\r\n\t});\r\n});\r\nfunction apbct_admin_sendAJAX(data, params, obj){\r\n\r\n\t// Default params\r\n\tvar callback    = params.callback    || null;\r\n\tvar callback_context = params.callback_context || null;\r\n\tvar callback_params = params.callback_params || null;\r\n\tvar async = params.async || true;\r\n\tvar notJson     = params.notJson     || null;\r\n\tvar timeout     = params.timeout     || 15000;\r\n\tvar obj         = obj                || null;\r\n\tvar button      = params.button      || null;\r\n\tvar spinner     = params.spinner     || null;\r\n\tvar progressbar = params.progressbar || null;\r\n\r\n\tif(typeof (data) === 'string') {\r\n\t\tdata = data + '&_ajax_nonce=' + ctAdminCommon._ajax_nonce + '&no_cache=' + Math.random();\r\n\t} else {\r\n\t\tdata._ajax_nonce = ctAdminCommon._ajax_nonce;\r\n\t\tdata.no_cache = Math.random();\r\n\t}\r\n\t// Button and spinner\r\n\tif(button)  {button.setAttribute('disabled', 'disabled'); button.style.cursor = 'not-allowed'; }\r\n\tif(spinner) jQuery(spinner).css('display', 'inline');\r\n\r\n\tjQuery.ajax({\r\n\t\ttype: \"POST\",\r\n\t\turl: ctAdminCommon._ajax_url,\r\n\t\tdata: data,\r\n\t\tasync: async,\r\n\t\tsuccess: function(result){\r\n\t\t\tif(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\r\n\t\t\tif(spinner)  jQuery(spinner).css('display', 'none');\r\n\t\t\tif(!notJson) result = JSON.parse(result);\r\n\t\t\tif(result.error){\r\n\t\t\t\tsetTimeout(function(){ if(progressbar) progressbar.fadeOut('slow'); }, 1000);\r\n\t\t\t\tif( typeof cleantalkModal !== 'undefined' ) {\r\n\t\t\t\t\t// Show the result by modal\r\n\t\t\t\t\tcleantalkModal.loaded = 'Error:<br>' + result.error.toString();\r\n\t\t\t\t\tcleantalkModal.open();\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert('Error happens: ' + (result.error || 'Unkown'));\r\n\t\t\t\t}\r\n\r\n\t\t\t}else{\r\n\t\t\t\tif(callback) {\r\n\t\t\t\t\tif (callback_params)\r\n\t\t\t\t\t\tcallback.apply( callback_context, callback_params.concat( result, data, params, obj ) );\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tcallback(result, data, params, obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function(jqXHR, textStatus, errorThrown){\r\n\t\t\tif(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\r\n\t\t\tif(spinner) jQuery(spinner).css('display', 'none');\r\n\t\t\tconsole.log('APBCT_AJAX_ERROR');\r\n\t\t\tconsole.log(jqXHR);\r\n\t\t\tconsole.log(textStatus);\r\n\t\t\tconsole.log(errorThrown);\r\n\t\t},\r\n\t\ttimeout: timeout,\r\n\t});\r\n}"],"names":["apbct_admin_sendAJAX","data","params","obj","callback","callback_context","callback_params","async","notJson","timeout","button","spinner","progressbar","ctAdminCommon","_ajax_nonce","Math","random","no_cache","setAttribute","style","cursor","jQuery","css","ajax","type","url","_ajax_url","success","result","removeAttribute","JSON","parse","error","setTimeout","fadeOut","cleantalkModal","loaded","toString","open","alert","apply","concat","jqXHR","textStatus","errorThrown","console","log","document","ready","$","on","ct_date","Date","getTime","ctSecure","location","protocol","cookie","toUTCString","e","apbct_notice_name","target","parent","attr","action","notice_id","closest","preventDefault","confirm","notice_when_deleting_user_text","window","this","href","click","spmOrderId","order_id","reload","message"],"mappings":"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"}